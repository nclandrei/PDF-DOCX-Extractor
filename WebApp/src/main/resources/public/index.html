<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0" />
	<title>CI Extraction Tool by Team X</title>
	<!-- CSS  -->
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection" />
	<link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection" />
    <link href="css/basic.min.css" type="text/css" rel="stylesheet" media="screen,projection" />
    <link href="css/dropzone.min.css" type="text/css" rel="stylesheet" media="screen,projection" />
	<style>
		input[type="file"] {
			display: none;
		}
	</style>
</head>
<body>

	<nav class="light-blue lighten-1" role="navigation">
		<div class="nav-wrapper container">
			<a id="logo-container" href="#" class="brand-logo">CI Extraction Tool</a>

			<ul class="right hide-on-med-and-down">
				<li><a href="#" id="bug-report-button">Submit a bug report</a></li>
				<li><a href="#">About</a></li>
				<li><a href="#">Team</a></li>
			</ul>
			<!--
				  <ul id="nav-mobile" class="side-nav">
					<li><a href="#">Team</a></li>
				  </ul>

				  <a href="#" data-activates="nav-mobile" class="button-collapse"><i class="material-icons">menu</i></a>
			-->
		</div>
	</nav>
	<div class="section no-pad-bot" id="index-banner">
		<div class="container">

			<h1 class="header center orange-text">Crichton Institute Extraction Tool</h1>
			<div class="row center">
				<h5 class="header col s12 light">A modern way to extract tables from PDF and DOCX files</h5>
			</div>
			<div class="row center">
				<!--
				<a href="http://materializecss.com/getting-started.html" id="download-button" class="btn-large waves-effect waves-light orange">upload file</a>
				-->
				<!--suppress HtmlUnknownTarget -->
				<form method="POST" action="uploadFile" id="localUpload" enctype="multipart/form-data">
					<label class="btn-large waves-effect waves-light orange" type="file" style="font-size:15px;margin-bottom:6px;">
						Upload file
						<i class="material-icons right">cloud</i>
						<input id="file-upload" type="file" name="file" accept="application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document" required />
					</label>
					<button class="btn-large waves-effect waves-light orange" type="submit" name="action" style="font-size:15px;margin-bottom:6px;">
						Submit
						<i class="material-icons right">send</i>
					</button>
					<div id="dropbox">Click on "Upload file" or </div>
				</form>
			</div>
		</div>
	</div>

	<div class="container">
		<div class="section">
			<!--   Icon Section   -->
			<div class="row">
				<div class="col s12 m4">
					<div class="icon-block">
						<h2 class="center light-blue-text"><i class="material-icons">flash_on</i></h2>
						<h5 class="center">Speedy Conversion</h5>
						<p class="light">Using the Tabula API our app manages to accomplish impressive conversion times even when it comes to gigantic files. </p>
					</div>
				</div>
				<div class="col s12 m4">
					<div class="icon-block">
						<h2 class="center light-blue-text"><i class="material-icons">settings</i></h2>
						<h5 class="center">Easy to work with</h5>
						<p class="light">We have put great care into providing the best possible user experience. To get started simply upload a PDF/DOCX file, wait for the conversion to happen, and download your CSV file.</p>
					</div>
				</div>
				<div class="col s12 m4">
					<div class="icon-block">
						<h2 class="center light-blue-text"><i class="material-icons">group</i></h2>
						<h5 class="center">Glasgow University Researched</h5>
						<p class="light">Throughout the development of this tool each iteration has been closely monitored by University staff to ensure it conforms to industry standards.</p>
					</div>
				</div>
			</div>
		</div>

		<div class="section">
		</div>
	</div>
	<footer class="page-footer orange">
		<div class="container">
			<div class="row">
				<div class="col l6 s12">
					<h5 class="white-text">Crichton Institute</h5>
					<p class="grey-text text-lighten-4">Crichton Institute is all about the local universities and colleges in the region working together for the region’s development, while making sure it is recognised both nationally and internationally. The partners are aware that successful regions are those who research and understand the issues, challenges and opportunities in their area and are, as a result, better positioned to make their case known where it matters.</p>

				</div>
				<div class="col l3 s12">
					<h5 class="white-text">Our Staff</h5>
					<p class="grey-text text-lighten-4">
						<div class="grey-text text-lighten-4">Eva Milroy</div>
						<div class="grey-text text-lighten-4">Crichton Institute</div>
						<div class="grey-text text-lighten-4">Development Officer</div>
						<div class="grey-text text-lighten-4">01387 345 370</div>
						<div class="grey-text text-lighten-4">eva.milroy@glasgow.ac.uk</div>
				</div>
				<div class="col l3 s12" style="">
					<h5 class="white-text">Social Media</h5>
					<ul>
						<li><a class="white-text" href="http://crichtoninstitute.co.uk/">Main Website</a></li>
						<li><a class="white-text" href="https://twitter.com/CrichtonInst">Twitter</a></li>
						<li><a class="white-text" href="https://www.linkedin.com/groups/4835261/profile">LinkedIn</a></li>
					</ul>
				</div>
			</div>
		</div>
		<div class="footer-copyright">
			<div class="container">
				Made by <a class="orange-text text-lighten-3" href="#">Team X @ University of Glasgow 2015 / 2016</a>
			</div>
		</div>
	</footer>
	<!-- Modal Structure -->
	<div id="modal1" class="modal modal-fixed-footer">
		<!--suppress HtmlUnknownTarget -->
		<form class="col s12" method="POST" action="send-mail" id="bug-report" enctype="multipart/form-data">
			<div class="modal-content">
				<h4>Submit a bug report</h4>
				<div class="row">
					<div class="row">
						<div class="input-field col s12">
							<textarea style="height: 23px;" id="bug" name="bug" class="materialize-textarea"></textarea>
							<label class="" for="bug">What bugs have you encountered?</label>
						</div>
					</div>
					<div class="row">
						<div class="input-field col s12">
							<textarea style="height: 23px;" id="device" name="device" class="materialize-textarea"></textarea>
							<label class="" for="device">What device are you running?</label>
						</div>
					</div>
					<div class="row">
						<div class="input-field col s12">
							<textarea style="height: 23px;" id="name" name="name" class="materialize-textarea"></textarea>
							<label class="" for="name">Please provide your name and email</label>
						</div>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button class="modal-action modal-close waves-effect waves-green btn-flat" type="submit" name="action">
					Submit
				</button>
			</div>
		</form>
	</div>
	<div id="previews" class="dropzone-previews" hidden></div>
	<div id="spinner"></div>
	<!--  Scripts-->
	<script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
	<script type="text/javascript" src="https://www.dropbox.com/static/api/2/dropins.js" id="dropboxjs" data-app-key="ismo0xlhjk13ve6"></script>
	<script src="js/materialize.js"></script>
	<script src="js/init.js"></script>
	<script src="js/spin.min.js"></script>
	<script src="js/dropzone.min.js"></script>
	<script>

		$(document).ready(function () {

			$('.modal-trigger').leanModal();
			$('#bug-report-button').on('click', function () {
				$('#modal1').openModal();
			});
			//$('#textarea1').val('New Text');
			$('#textarea1').trigger('autoresize');

			$('#file-upload').on('change', function () {
				var myFile = $(this).val();
				var ext = myFile.split('.').pop();
				if (ext != "docx" && ext != "" && ext != null) {
					//noinspection JSUnusedAssignment
					myFile = $(this).val(null);
					alert("Extension ." + ext + " is not supported."
							+ " This tool does only work with Microsoft Office .docx documents!");
				}
			});

			$('#localUpload').submit(function (e) {
				e.preventDefault();
				$('#spinner').spin('default');
				var formData = new FormData(document.getElementById("localUpload"));
				$.ajax({
					type: "POST",
					url: "/uploadFile",
					enctype: 'multipart/form-data',
					data: formData,
					processData: false,
					contentType: false,
					success: function (result) {
						$('#spinner').spin(false);
						location.href = result;
					},
					error: function (e) {
						alert('Failure ' + e.status);
					}
				});
			});

			// drag and drop
			new Dropzone(document.body, {
                url: "/uploadFile",
                maxFilesize: 25,
                uploadMultiple: false,
                maxFiles: 1,
                acceptedFiles: "application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document",
                accept: function(file, done) {
                    $('#spinner').spin('default');
                    done();
                },
                processData: false,
				contentType: false,
				previewsContainer: "#previews",
				success: function (result) {
					$('#spinner').spin(false);
					//noinspection JSValidateTypes
					location.href = result.xhr.response;
				},
				error: function (e) {
					alert('Failure ' + e.status);
				}
			});

			$('#bug-report').submit(function (e) {
				e.preventDefault();
				$('#spinner').spin('default');
				var formData = new FormData(document.getElementById("bug-report"));
				$.ajax({
					type: "POST",
					url: "/send-mail",
					enctype: 'multipart/form-data',
					data: formData,
					processData: false,
					contentType: false,
					success: function (result) {
						$('#spinner').spin(false);
						alert(result);
					},
					error: function (e) {
						alert('Failure ' + e.status);
					}
				});
			});

			var button = Dropbox.createChooseButton({
				// Required. Called when a user selects an item in the Chooser.
				success: function (files) {
					//noinspection JSUnresolvedVariable
					if (files[0].bytes <= 26214400) {
						$('#spinner').spin('default');
						$.ajax({
							type: "POST",
							url: "/uploadFileDropbox",
							data: {
								file: files[0].link,
								fileName: files[0].name
							},
							success: function (result) {
								$('#spinner').spin(false);
								location.href = result;
							},
							error: function (e) {
								alert('Failure ' + e.status);
							}
						});
					} else {
						//noinspection JSUnresolvedVariable
						alert(files[0].name +
								$([files[0].bytes]).map(function () { return " (" + (this / 1024 / 1024).toFixed(2) + " MB)" })[0] +
							" is too big! Maximum file size is 25MB.")
					}
				},

				// Optional. Called when the user closes the dialog without selecting a file
				// and does not include any parameters.
				cancel: function () {

				},

				// Optional. "preview" (default) is a preview link to the document for sharing,
				// "direct" is an expiring link to download the contents of the file. For more
				// information about link types, see Link types below.
				linkType: "direct", // or "direct"

				// Optional. A value of false (default) limits selection to a single file, while
				// true enables multiple file selection.
				multiselect: false, // or true

				// Optional. This is a list of file extensions. If specified, the user will
				// only be able to select files with these extensions. You may also specify
				// file types, such as "video" or "images" in the list. For more information,
				// see File types below. By default, all extensions are allowed.
				extensions: ['.docx']
			});

			document.getElementById("dropbox").appendChild(button);

			// loading spinner
			(function (factory) {
				//noinspection JSUnresolvedVariable
				if (typeof exports == 'object') {
					// CommonJS
					//noinspection JSUnresolvedFunction
					factory(require('jquery'), require('spin.js'))
				} else { //noinspection JSUnresolvedVariable
					if (typeof define == 'function' && define.amd) {
						// AMD, register as anonymous module
						//noinspection JSUnresolvedFunction
						define(['jquery', 'spin'], factory)
					} else {
						// Browser globals
						if (!window.Spinner) throw new Error('Spin.js not present');
						factory(window.jQuery, window.Spinner)
					}
				}

			}(function ($, Spinner) {

				$.fn.spin = function (opts, color) {

					return this.each(function () {
						var $this = $(this)
                                , data = $this.data();

						if (data.spinner) {
							data.spinner.stop();
							delete data.spinner
						}
						if (opts !== false) {
							opts = $.extend(
                                    { color: color || $this.css('color') }
                                    , $.fn.spin.presets[opts] || opts
                            );
							data.spinner = new Spinner(opts).spin(this)
						}
					})
				};

				$.fn.spin.presets = {
					tiny: { lines: 8, length: 2, width: 2, radius: 3 }
                    , small: { lines: 8, length: 4, width: 3, radius: 5 }
                    , large: { lines: 10, length: 8, width: 4, radius: 8 }
                    , default: {
                    	lines: 13 // The number of lines to draw
                        , length: 28 // The length of each line
                        , width: 14 // The line thickness
                        , radius: 42 // The radius of the inner circle
                        , scale: 1 // Scales overall size of the spinner
                        , corners: 1 // Corner roundness (0..1)
                        , color: '#000' // #rgb or #rrggbb or array of colors
                        , opacity: 0.25 // Opacity of the lines
                        , rotate: 0 // The rotation offset
                        , direction: 1 // 1: clockwise, -1: counterclockwise
                        , speed: 1 // Rounds per second
                        , trail: 60 // Afterglow percentage
                        , fps: 20 // Frames per second when using setTimeout() as a fallback for CSS
                        , zIndex: 2e9 // The z-index (defaults to 2000000000)
                        , className: 'spinner' // The CSS class to assign to the spinner
                        , top: '50%' // Top position relative to parent
                        , left: '50%' // Left position relative to parent
                        , shadow: false // Whether to render a shadow
                        , hwaccel: false // Whether to use hardware acceleration
                        , position: 'absolute' // Element positioning
                    }
				}
			}));
		});

	</script>
</body>
</html>

