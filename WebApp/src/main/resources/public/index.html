<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0" />
	<title>CI Extraction Tool by Team X</title>
	<!-- CSS  -->
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection" />
	<link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection" />
	<link href='http://fonts.googleapis.com/css?family=Lato&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
	<link rel="icon" href="favicon.ico" type="image/x-icon" />
	<style>
		input[type="file"] {
			display: none;
		}
	</style>
</head>
<body>

<div class="container-fluid">
<!--
	<div style="display:inline-block">
		<p id="header-text">UNDERSTANDING YOUR REGION</p>
		<p id="header-text">OPEN INFORMATION FOR ALL</p>
		<p id="header-text2">THE DATA OBSERVATORY FOR DUMFRIES &amp; GALLOWAY AND THE SOUTH OF SCOTLAND</p>
		<!--<img src="logo.png" alt="" id="header-img" height="96" width="300">
	</div>
-->

</div>

<nav class="light-blue lighten-1" role="navigation">
	<div class="nav-wrapper container">
		<a id="logo-container" href="#" class="brand-logo"><img src="logo.png" alt="" id="header-img"><span style="font-family:'Lato'; position:relative; top:-24px; left:10px; font-weight:900; letter-spacing:-2px;"><span style="color:#333;">Crichton</span> <span style="color:#4F9149;">Institute</span></span></a>

		<ul class="right hide-on-med-and-down">
			<li><!--suppress XmlDuplicatedId -->
                <a href="#" id="bug-report-button">Submit a bug report</a></li>
			<li><a href="#">About</a></li>
			<li><a href="#" id="team-button">Team</a></li>
		</ul>
		<ul id="nav-mobile" class="side-nav">
			<li><!--suppress XmlDuplicatedId -->
                <a href="#" id="bug-report-button">Submit a bug report</a></li>
			<li><a href="#">About</a></li>
			<li><a href="#">Team</a></li>
		</ul>
		<a href="#" data-activates="nav-mobile" class="button-collapse"><i class="material-icons">menu</i></a>
	</div>
</nav>
<div class="section no-pad-bot" id="index-banner">
	<div class="container">

		<h1 class="header center orange-text">Crichton Institute Extraction Tool</h1>
		<div class="row center">
			<h5 class="header col s12 light">A modern way to extract tables from PDF and DOCX files</h5>
		</div>
		<div class="row center">
			<!--
            <a href="http://materializecss.com/getting-started.html" id="download-button" class="btn-large waves-effect waves-light orange">upload file</a>
            -->
			<!--suppress HtmlUnknownTarget -->
			<form method="POST" action="uploadFile" id="localUpload" enctype="multipart/form-data">
				<label class="btn-large waves-effect waves-light orange" type="file" style="font-size:15px;margin-bottom:6px;">
					Upload file
					<i class="material-icons right">cloud</i>
					<input id="file-upload" type="file" name="file" accept="application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document" required />
				</label>
				<button data-target="modal2" class="btn modal-trigger btn-large waves-effect waves-light orange" id="submit-button" style="font-size:15px;margin-bottom:6px;" disabled>
					Submit
					<i class="material-icons right">send</i>
				</button>
                <div id="modal2" class="modal modal-fixed-footer">
                    <div class="modal-content">
                        <h4>Important notice</h4>
                        <p>The preferred filetype for this tool is <b>DOCX</b> (Microsoft Word). <b>PDF</b>
							files are also supported, however, 100% accurancy is not guaranteed. Please read the terms of service
							and privacy policy below and only use the tool if you agree with them.</p>
						<h5>Terms of Service</h5>
						<h6>
							1. Terms
						</h6>
						<p> By accessing this web site, you are agreeing to be bound by these web site Terms
							and Conditions of Use, all applicable laws and regulations, and agree that you
							are responsible for compliance with any applicable local laws. If you do not agree
							with any of these terms, you are prohibited from using or accessing this site.
							The materials contained in this web site are protected by applicable copyright
							and trade mark law. </p>
						<h6>
							2. Use License
						</h6>
						<ol type="a">
							<li> Permission is granted to temporarily download one copy of the materials (information
								or software) on Crichton Institute's web site for personal, non-commercial transitory
								viewing only. This is the grant of a license, not a transfer of title, and under
								this license you may not:
								<ol type="i">
									<li>modify or copy the materials;</li>
									<li>use the materials for any commercial purpose, or for any public display (commercial
										or non-commercial);</li>
									<li>attempt to decompile or reverse engineer any software contained on Crichton
										Institute's web site;</li>
									<li>remove any copyright or other proprietary notations from the materials; or</li>
									<li>transfer the materials to another person or "mirror" the materials on any other
										server.</li>
								</ol>
							</li>
							<li> This license shall automatically terminate if you violate any of these restrictions
								and may be terminated by Crichton Institute at any time. Upon terminating your
								viewing of these materials or upon the termination of this license, you must
								destroy any downloaded materials in your possession whether in electronic or
								printed format. </li>
						</ol>
						<h6>
							3. Disclaimer
						</h6>
						<ol type="a">
							<li> The materials on Crichton Institute's web site are provided "as is". Crichton Institute
								makes no warranties, expressed or implied, and hereby disclaims and negates all
								other warranties, including without limitation, implied warranties or conditions
								of merchantability, fitness for a particular purpose, or non-infringement of
								intellectual property or other violation of rights. Further, Crichton Institute
								does not warrant or make any representations concerning the accuracy, likely
								results, or reliability of the use of the materials on its Internet web site
								or otherwise relating to such materials or on any sites linked to this site.
							</li>
						</ol>
						<h6>
							4. Limitations
						</h6>
						<p> In no event shall Crichton Institute or its suppliers be liable for any damages (including,
							without limitation, damages for loss of data or profit, or due to business interruption,)
							arising out of the use or inability to use the materials on Crichton Institute's
							Internet site, even if Crichton Institute or a Crichton Institute authorized representative
							has been notified orally or in writing of the possibility of such damage. Because
							some jurisdictions do not allow limitations on implied warranties, or limitations
							of liability for consequential or incidental damages, these limitations may not
							apply to you. </p>
						<h6>
							5. Revisions and Errata
						</h6>
						<p> The materials appearing on Crichton Institute's web site could include technical,
							typographical, or photographic errors. Crichton Institute does not warrant that
							any of the materials on its web site are accurate, complete, or current. Crichton
							Institute may make changes to the materials contained on its web site at any time
							without notice. Crichton Institute does not, however, make any commitment to update
							the materials. </p>
						<h6>
							6. Links
						</h6>
						<p> Crichton Institute has not reviewed all of the sites linked to its Internet web site
							and is not responsible for the contents of any such linked site. The inclusion
							of any link does not imply endorsement by Crichton Institute of the site. Use of
							any such linked web site is at the user's own risk. </p>
						<h6>
							7. Site Terms of Use Modifications
						</h6>
						<p> Crichton Institute may revise these terms of use for its web site at any time without
							notice. By using this web site you are agreeing to be bound by the then current
							version of these Terms and Conditions of Use. </p>
						<h6>
							8. Governing Law
						</h6>
						<p> Any claim relating to Crichton Institute's web site shall be governed by the laws
							of the State of United Kingdom without regard to its conflict of law provisions.
						</p>
						<p> General Terms and Conditions applicable to Use of a Web Site. </p>
						<h5>
							Privacy Policy
						</h5>
						<p> Your privacy is very important to us. Accordingly, we have developed this Policy
							in order for you to understand how we collect, use, communicate and disclose and
							make use of personal information. The following outlines our privacy policy. </p>
						<ul>
							<li> Before or at the time of collecting personal information, we will identify the
								purposes for which information is being collected. </li>
							<li> We will collect and use of personal information solely with the objective of fulfilling
								those purposes specified by us and for other compatible purposes, unless we obtain
								the consent of the individual concerned or as required by law. </li>
							<li> We will only retain personal information as long as necessary for the fulfillment
								of those purposes. </li>
							<li> We will collect personal information by lawful and fair means and, where appropriate,
								with the knowledge or consent of the individual concerned. </li>
							<li> Personal data should be relevant to the purposes for which it is to be used, and,
								to the extent necessary for those purposes, should be accurate, complete, and
								up-to-date. </li>
							<li> We will protect personal information by reasonable security safeguards against
								loss or theft, as well as unauthorized access, disclosure, copying, use or modification.
							</li>
							<li> We will make readily available to customers information about our policies and
								practices relating to the management of personal information. </li>
						</ul>
						<p> We are committed to conducting our business in accordance with these principles in
							order to ensure that the confidentiality of personal information is protected and
							maintained. </p>
					</div>
                    <div class="modal-footer">
						<button id="agreeToUpload" class=" modal-action modal-close waves-effect waves-light btn orange" type="submit" name="action" style="margin-left:4px;">Agree</button>
                        <a href="#" class=" modal-action modal-close waves-effect waves-light btn">Cancel</a>
                    </div>
                </div>

				<div id="dropbox">Click on "Upload file" or </div>
			</form>
		</div>
	</div>
</div>

<div class="container">
	<div class="section">
		<!--   Icon Section   -->
		<div class="row">
			<div class="col s12 m4">
				<div class="icon-block">
					<h2 class="center light-blue-text"><i class="material-icons">flash_on</i></h2>
					<h5 class="center">Speedy Conversion</h5>
					<p class="light">Using the Tabula API our app manages to accomplish impressive conversion times even when it comes to gigantic files. </p>
				</div>
			</div>
			<div class="col s12 m4">
				<div class="icon-block">
					<h2 class="center light-blue-text"><i class="material-icons">settings</i></h2>
					<h5 class="center">Easy to work with</h5>
					<p class="light">We have put great care into providing the best possible user experience. To get started simply upload a PDF/DOCX file, wait for the conversion to happen, and download your CSV file.</p>
				</div>
			</div>
			<div class="col s12 m4">
				<div class="icon-block">
					<h2 class="center light-blue-text"><i class="material-icons">group</i></h2>
					<h5 class="center">Glasgow University Researched</h5>
					<p class="light">Throughout the development of this tool each iteration has been closely monitored by University staff to ensure it conforms to industry standards.</p>
				</div>
			</div>
		</div>
	</div>

	<div class="section">
	</div>
</div>
<footer class="page-footer orange">
	<div class="container">
		<div class="row">
			<div class="col l6 s12">
				<h5 class="white-text">Crichton Institute</h5>
				<p class="grey-text text-lighten-4">Crichton Institute is all about the local universities and colleges in the region working together for the region’s development, while making sure it is recognised both nationally and internationally. The partners are aware that successful regions are those who research and understand the issues, challenges and opportunities in their area and are, as a result, better positioned to make their case known where it matters.</p>

			</div>
			<div class="col l3 s12">
				<h5 class="white-text">Our Staff</h5>
				<p class="grey-text text-lighten-4">
				<div class="grey-text text-lighten-4">Eva Milroy</div>
				<div class="grey-text text-lighten-4">Crichton Institute</div>
				<div class="grey-text text-lighten-4">Development Officer</div>
				<div class="grey-text text-lighten-4">01387 345 370</div>
				<div class="grey-text text-lighten-4">eva.milroy@glasgow.ac.uk</div>
			</div>
			<div class="col l3 s12" style="">
				<h5 class="white-text">Social Media</h5>
				<ul>
					<li><a class="white-text" href="http://crichtoninstitute.co.uk/">Main Website</a></li>
					<li><a class="white-text" href="https://twitter.com/CrichtonInst">Twitter</a></li>
					<li><a class="white-text" href="https://www.linkedin.com/groups/4835261/profile">LinkedIn</a></li>
				</ul>
			</div>
		</div>
	</div>
	<div class="footer-copyright">
		<div class="container">
			Made by <a class="orange-text text-lighten-3" href="#">Team X @ University of Glasgow 2015 / 2016</a>
		</div>
	</div>
</footer>
<!-- Modal Structure -->
<div id="modal1" class="modal modal-fixed-footer">
	<!--suppress HtmlUnknownTarget -->
	<form class="col s12" method="POST" action="send-mail" id="bug-report" enctype="multipart/form-data">
		<div class="modal-content">
			<h4>Submit a bug report</h4>
			<div class="row">
				<div class="row">
					<div class="input-field col s12">
						<textarea style="height: 23px;" id="bug" name="bug" class="materialize-textarea validate" required></textarea>
						<label class="" for="bug" data-error="wrong">What bugs have you encountered?</label>
					</div>
				</div>
				<div class="row">
					<div class="input-field col s12">
						<textarea style="height: 23px;" id="device" name="device" class="materialize-textarea validate" required></textarea>
						<label class="" for="device">What device are you running?</label>
					</div>
				</div>
				<div class="row">
					<div class="input-field col s12">
						<textarea style="height: 23px;" id="name" name="name" class="materialize-textarea validate" required></textarea>
						<label class="" for="name">Please provide your name and email</label>
					</div>
				</div>
			</div>
		</div>
		<div class="modal-footer">
			<button class="waves-effect waves-green btn-flat submit" type="submit" value="Submit" id="bug-report-submit">
				Submit
			</button>
		</div>
	</form>
</div>
<div id="modal3" class="modal modal-fixed-footer">
	<div class="modal-content">
		<h4>University of Glasgow : Team X</h4>
		<p>This application was developed by a team of five students at Glasgow University supervised by senior lecturer Timothy Storer.</p>
		<div class="row">
			<div class="col s12 m4 l4">
				<img src="http://placehold.it/140x140" class="teamAvatar">
				<span>Andrei Nicolae</span>
				<span>Chief Architect</span>
			</div>
			<div class="col s12 m4 l4">
				<img src="http://placehold.it/140x140" class="teamAvatar">
				<span>Edvinas Simkus</span>
				<span>Quality Assurance</span>
			</div>
			<div class="col s12 m4 l4">
				<img src="http://placehold.it/140x140" class="teamAvatar">
				<span>Richard Pearson</span>
				<span>Client Liason</span>
			</div>
			</div>
		<div class="row">
			<div class="col s12 m4 l4">
				<img src="http://placehold.it/140x140" class="teamAvatar">
				<span>Ivan Kyosev</span>
				<span>Toolsmith</span>
			</div>
			<div class="col s12 m4 l4">
				<img src="http://placehold.it/140x140" class="teamAvatar">
				<span>Ian Denev</span>
				<span>Project Manager</span>
			</div>
			<div class="col s12 m4 l4">
				<img src="img/tim.jpg" class="teamAvatar">
				<span>Tim Storer</span>
				<span>UoG SoftEng Coordinator</span>
			</div>
		</div>
	</div>
	<div class="modal-footer">
		<a href="#!" class=" modal-action modal-close waves-effect waves-green btn-flat">OK</a>
	</div>
</div>
<div id="previews" class="dropzone-previews" hidden></div>
<div id="spinner"></div>
<!--  Scripts-->
<script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
<script src="https://ajax.aspnetcdn.com/ajax/jquery.validate/1.14.0/jquery.validate.min.js"></script>
<script src="js/materialize.js"></script>
<script src="js/init.js"></script>
<script src="js/spin.min.js"></script>
<script src="js/dropzone.min.js"></script>
<script type="text/javascript" src="https://www.dropbox.com/static/api/2/dropins.js" id="dropboxjs" data-app-key="ismo0xlhjk13ve6"></script>

<script>

	$(document).ready(function () {

		$('.modal-trigger').leanModal();

		$('#bug-report-button').on('click', function () {
			$('#modal1').openModal();
		});

		$('#team-button').on('click', function () {
			$('#modal3').openModal();
		});

		$('#textarea1').trigger('autoresize');

        $('.button-collapse').sideNav({
                closeOnClick: true
            }
        );

		$('#file-upload').on('change', function () {
			var myFile = $(this).val();
			var ext = myFile.split('.').pop();
			if (ext != "docx" && ext != "pdf" && ext != null) {
				//noinspection JSUnusedAssignment
				myFile = $(this).val(null);
                alert("Extension ." + ext + " is not supported."
						+ " This tool does work with Microsoft Office .docx and .pdf documents only!");
                $('#submit-button').attr("disabled", true);
			} else {
                $('#submit-button').attr("disabled", false);
            }
		});

		$('#localUpload').submit(function (e) {
			e.preventDefault();
            $('#spinner').spin('default');
            var formData = new FormData(document.getElementById("localUpload"));
            $.ajax({
                type: "POST",
                url: "/uploadFile",
                enctype: 'multipart/form-data',
                data: formData,
                processData: false,
                contentType: false,
                success: function (result) {
                    console.log("inside ajax");
                    $('#spinner').spin(false);
                    location.href = result;
                },
                error: function (e) {
                    alert('Failure ' + e.status);
                }
            });
		});

		// drag and drop
		new Dropzone(document.body, {
			url: "/uploadFile",
			maxFilesize: 25,
			uploadMultiple: false,
			maxFiles: 1,
			acceptedFiles: "application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document",
			accept: function(file, done) {
				$('#spinner').spin('default');
				done();
			},
			processData: false,
			contentType: false,
			previewsContainer: "#previews",
			success: function (result) {
				$('#spinner').spin(false);
				//noinspection JSValidateTypes
				location.href = result.xhr.response;
			},
			error: function (e) {
				alert('Failure ' + e.status);
			}
		});

        $('#bug-report').validate({
            errorClass: 'invalid',
            errorPlacement: function (error, element) {
                element.next("label").attr("data-error", error.contents().text());
            }
        });

		$('#bug-report').submit(function (e) {
			e.preventDefault();
            var isvalidate=$("#bug-report").valid();
            if(isvalidate) {
                $('#modal1').closeModal();
                $('#spinner').spin('default');
                var formData = new FormData(document.getElementById("bug-report"));
                $.ajax({
                    type: "POST",
                    url: "/send-mail",
                    enctype: 'multipart/form-data',
                    data: formData,
                    processData: false,
                    contentType: false,
                    success: function (result) {
                        $('#spinner').spin(false);
                        alert(result);
                    },
                    error: function (e) {
                        alert('Failure ' + e.status);
                    }
                });
            }
		});

		var button = Dropbox.createChooseButton({
			// Required. Called when a user selects an item in the Chooser.
			success: function (files) {
				//noinspection JSUnresolvedVariable
				if (files[0].bytes <= 26214400) {
					$('#spinner').spin('default');
					$.ajax({
						type: "POST",
						url: "/uploadFileDropbox",
						data: {
							file: files[0].link,
							fileName: files[0].name
						},
						success: function (result) {
							$('#spinner').spin(false);
							location.href = result;
						},
						error: function (e) {
							alert('Failure ' + e.status);
						}
					});
				} else {
					//noinspection JSUnresolvedVariable
					alert(files[0].name +
							$([files[0].bytes]).map(function () { return " (" + (this / 1024 / 1024).toFixed(2) + " MB)" })[0] +
							" is too big! Maximum file size is 25MB.")
				}
			},
			cancel: function () {

			},
			linkType: "direct",
			multiselect: false,
			extensions: ['.pdf', '.docx']
		});

		document.getElementById("dropbox").appendChild(button);

		// loading spinner
		(function (factory) {
			//noinspection JSUnresolvedVariable
			if (typeof exports == 'object') {
				// CommonJS
				//noinspection JSUnresolvedFunction
				factory(require('jquery'), require('spin.js'))
			} else { //noinspection JSUnresolvedVariable
				if (typeof define == 'function' && define.amd) {
					// AMD, register as anonymous module
					//noinspection JSUnresolvedFunction
					define(['jquery', 'spin'], factory)
				} else {
					// Browser globals
					if (!window.Spinner) throw new Error('Spin.js not present');
					factory(window.jQuery, window.Spinner)
				}
			}

		}(function ($, Spinner) {

			$.fn.spin = function (opts, color) {

				return this.each(function () {
					var $this = $(this)
							, data = $this.data();

					if (data.spinner) {
						data.spinner.stop();
						delete data.spinner
					}
					if (opts !== false) {
						opts = $.extend(
								{ color: color || $this.css('color') }
								, $.fn.spin.presets[opts] || opts
						);
						data.spinner = new Spinner(opts).spin(this)
					}
				})
			};

			$.fn.spin.presets = {
				tiny: { lines: 8, length: 2, width: 2, radius: 3 }
				, small: { lines: 8, length: 4, width: 3, radius: 5 }
				, large: { lines: 10, length: 8, width: 4, radius: 8 }
				, default: {
					lines: 13 // The number of lines to draw
					, length: 28 // The length of each line
					, width: 14 // The line thickness
					, radius: 42 // The radius of the inner circle
					, scale: 1 // Scales overall size of the spinner
					, corners: 1 // Corner roundness (0..1)
					, color: '#000' // #rgb or #rrggbb or array of colors
					, opacity: 0.25 // Opacity of the lines
					, rotate: 0 // The rotation offset
					, direction: 1 // 1: clockwise, -1: counterclockwise
					, speed: 1 // Rounds per second
					, trail: 60 // Afterglow percentage
					, fps: 20 // Frames per second when using setTimeout() as a fallback for CSS
					, zIndex: 2e9 // The z-index (defaults to 2000000000)
					, className: 'spinner' // The CSS class to assign to the spinner
					, top: '50%' // Top position relative to parent
					, left: '50%' // Left position relative to parent
					, shadow: false // Whether to render a shadow
					, hwaccel: false // Whether to use hardware acceleration
					, position: 'absolute' // Element positioning
				}
			}
		}));
	});

</script>
</body>
</html>
